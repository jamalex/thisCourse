galleryimport = {"Fusiform": ["fusiform-1.png", "fusiform-2.jpg", "fusiform-3.png", "fusiform-4.png", "fusiform-5.png","fuisiform-6.bmp"], "Parietal Lobe": ["parietal-1.jpg", "parietal-2.png", "parietal-3.jpg", "parietal-4.jpg"], "Lateral Occipital": ["lat-occipital-2.gif", "lat-occiptal-3.jpg", "lat-occiptal-4.jpg", "lateral-occipital-1.gif"], "Caudate": ["caudate-1.jpg", "caudate-2.jpg", "caudate-3.png", "caudate-4.jpg", "caudate_lentiform.jpg"], "Intraparietal Sulcus": ["intrapar-sulcus-1.jpg", "intrapar-sulcus-2.png", "intrapar-sulcus-3.gif", "intrapar-sulcus-4.jpg"], "Temporo-Parietal": ["tempero-parietal-2.jpg", "tempero-paritetal-1.jpg", "temporo-parietal-3.png"], "Dorsal-Ventral-Stream": ["dorsal-ventral-stream-1.gif", "dorsal-ventral-stream-2.jpg", "dorsal-ventral-stream-3.png"], "Inferior-Frontal Gyrus": ["inf-front-2.png", "inf-front-3.png", "inf-front-4.png", "inf-front-5.png", "inf-frontal-1.jpg"], "Subthalamic Nucleus": ["subtal-3.png", "subthal-1.png", "subthal-2.jpg", "subthal-4.jpg", "subthal-5.jpg"], "Ventromedial Prefrontal Cortex": ["ventromedial-1.jpg", "ventromedial-2.gif", "Ventromedial-3.png", "Ventromedial-4.png"], "Insula": ["insula-1.png", "insula-2.png", "insula-3.jpg", "insula-4.png", "insula-5.png"], "Thalamus": ["Thal-1-ani.gif", "thal-2.jpg", "thal-3.png", "thal-4.jpg", "thal-5.jpg"], "Orbitofrontal": ["orbitofronal-4.png", "orbitofrontal-1.png", "orbitofrontal-2.jpg", "orbitofrontal-3.png"], "Hippocampus": ["hippocampus-1.png", "hippocampus-2.png", "hippocampus-3.jpg", "hippocampus-4.png", "hippocampus2.gif"], "Lgn-Thalamus": ["lgn-1.png", "lgn-2.jpg", "lgn-3.png", "lgn-4.png", "lgn-5.png"], "Dorsal-Ventral": ["dorsa_-ventral -2.gif", "dorsal_ventral-1.gif", "dorsal_ventral-3.jpg", "dorsal_ventral-4.jpg"], "Frontal Lobe": ["frontal-1.jpg", "frontal-2.png", "frontal-3.gif", "frontal-4.gif"], "Pars Opercularis": ["pars-opercularis-1.png", "pars-opercularis-3.png", "pars-opercularis-ani-2.gif"], "Dmpfc": ["dmpfc-1.jpg", "dmpfc-2.gif", "dmpfc-3.png", "dmpfc-4.png"], "Basal Ganglia": ["bg-1.jpg", "bg-2.jpg", "bg-3.png", "bg-4.jpg", "bg-5.jpg"], "Amygdala": ["amygdala-1.png", "amygdala-2.jpg", "amygdala-3.gif", "amygdala-4.png", "amygdala-5.png", "amygdala-6.png"], "Cerebellum": ["Cerebellum-1.png", "cerebellum-2.jpg", "cerebellum-3.jpg", "cerebellum-4.jpg", "cerebellum-5.jpg"], "Superior Parital Lobule": ["sup-parietal-lobule-1.png", "sup-parietal-lobule-2.png", "sup-parietal-lobule-3.png", "sup-parietal-lobule-4.png"], "Ventral Striatum": ["ventral-striatum-1.png", "ventral-striatum-2.gif", "ventral_striatum-3.PNG", "ventral_striatum-4.jpg"], "Cingulate": ["cingulate-1.jpg", "cingulate-2.JPG", "cingulate-3.png", "cingulate-4.JPG", "cingulate-6.png", "cingulate5.jpg"], "Sma-Presma": ["sma-presma-1.jpg", "sma-presma-2.jpg", "sma-presma-3.png", "sma-presma-4.png", "sma-presma-5.png", "sma-presma-6.jpg"], "Frontal Eye Fields (Fef)": ["FEF-1.png", "FEF-2.png", "FEF-3.png", "FEF-4.png", "FEF-5.png", "FEF1.JPG", "fef3.jpg"], "Parahippocampal": ["parahipocampal-3.png", "parahippocampal-1.gif", "parahippocampal-2.png", "parahippocampal-4.jpg"], "Middle Frontal Gyrus": ["middle-frontal-gyrus-1.png", "middle-frontal-gyrus-2.png", "middle-frontal-gyrus-4.png", "middle-frontal-gyrus-ani-3.gif"], "Occipital_Cortex": ["occipital-1.png", "occipital-2.png", "occipital-3.png", "occipital-5.png", "occiptal-4.jpg"], "Dorsal_Striatum": ["dorsal_striatum-1.png", "dorsal_striatum-2.jpg"], "Intraparietal (Lip)": ["ips-1.png", "ips-3.jpg", "lip-2.png", "lip-3.jpg", "lip-4.png"], "Precuneus": ["Precuneus-1.png", "precuneus-2.png", "Precuneus-3.gif", "precuneus-4.jpg"], "Striate Cortex": ["striate-1.png", "striate-2.png", "striate-3.png", "striate-4.png", "striate-5.png"], "Dlpfc": ["dlpfc-1.png", "dlpfc-2.png", "dlpfc-3.jpg", "dlpfc4.PNG"], "Accumbens": ["accumbens-1.png", "accumbens-2.jpg", "accumbens-3.jpg", "accumbens-4.PNG", "accumbens-5.jpg"], "Fronto-Parietal": ["frontopariental-5-ani.gif", "frontoparietal-1.jpg", "frontoparietal-2.jpg", "frontoparietal-3.jpg", "frontoparietal-4.jpg"], "Prefrontal Cortex": ["prefrontal_cortex-1.gif", "prefrontal_cortex-2.jpg", "prefrontal_cortex-3.jpg", "prefrontal_cortex-4.jpg", "prefrontal_cortex_5.JPG"], "Pregenual Cingulate": ["pregenual-1.png", "pregenual-2.jpg", "pregenual-3.png", "pregenual-4.jpg"], "Anterior Cingulate": ["ant_cingulate-1.png", "ant_cingulate-2.JPG", "ant_cingulate-3.png", "ant_cingulate-4.jpg"], "Lateral Prefrontal": ["lateral-prefront-1.jpg", "lateral-prefront-2.jpg", "lateral-prefront-3.jpg"], "Superior-Temp-Sulcas-Gyrus": ["STS-1.png", "sts-2.png", "STS-3.png", "STS-4.jpg"], "Ventral-Prefrontal": ["ventral-prefrontal-1.png", "ventral-prefrontal-2.png", "ventral-prefrontal-3.png"], "Subgenual Anterior Cingulate (45)": ["subgenual-1.png", "subgenual-2.png", "subgenual-3.png", "subgenual-4.jpg", "subgenual-5.jpg"]}

nuggetlist = require('app').get('course').get('nuggets')

refirst = new RegExp('-1\.')

require ['cs!file/models'], (filemodels) =>
    FileModel = filemodels.FileModel
    _.each galleryimport, (imagelist,galleryname) =>
        nuggetlist.create {title: galleryname, tags: ['Anatomy',galleryname]},
            success: (nugget) =>
                nugget.get('page').save().success =>
                    nugget.get('page').get('contents').create {title:'Gallery'},
                        success: (subpage) =>
                            subpage.get('sections').create {type: 'gallery'},
                                success: (section) =>
                                    imagelist.forEach (image) =>
                                        url = '/s3/uploaded_image?image_key=uploads/'+image+'&thumb_key=uploads/thumb-'+image
                                        $.get url, (response) =>
                                            section.get('items').create {file: response._id}
                                            file = new FileModel(_id:response._id)
                                            file.set(tags: ['Anatomy',galleryname]).save()
                                            if refirst.test(image) then nugget.set(preview:"<img src='/s3/thumb_redirect?id=#{response._id}'/>").save()